<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fretes e Mudan√ßas</title>
  <meta property="og:title" content="Fretes e Mudan√ßas">
  <meta property="og:description" content="Servi√ßo de fretes e mudan√ßas r√°pido e seguro.">
  <meta property="og:image" content="https://i.imgur.com/4JLgWQN.png">
  <meta property="og:url" content="https://www.FretesOuMudancas.com.br">
  <meta property="og:type" content="website">
  <style>
    body, html {
      font-family: Arial, sans-serif;
      height: 100%;
      margin: 0;
      background-color: #e5ddd5;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }
    .chat-container {
      width: 100%;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      background-color: #e5ddd5;
      background-image: url('https://web.whatsapp.com/img/bg-chat-tile_aa7fd7a2a0f05f5e5a6e9808b55e0e28.png');
      visibility: hidden;
    }
    .barra-superior {
      background-color: #075e54;
      color: white;
      padding: 10px;
      text-align: center;
      font-size: 24px;
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      z-index: 1;
    }
    .mensagens {
      overflow-y: auto;
      padding: 10px;
      display: flex;
      flex-direction: column;
      height: calc(100vh - 160px);
      margin-top: 60px;
      margin-bottom: 10px;
      flex-grow: 1;
      padding-top: 35px; /* Ajusta o espa√ßo extra no topo */
      padding-bottom: calc(32px + env(safe-area-inset-bottom, 16px));
    }
    .chat-message {
      margin: 5px 0;
      padding: 15px;
      border-radius: 10px;
      font-size: 18px;
      max-width: 80%;
      word-wrap: break-word;
      position: relative;
    }
    .chat-bot {
      background-color: #dcf8c6;
      color: #000;
      align-self: flex-start;
    }
    .chat-user {
      background-color: #25d366;
      color: white;
      align-self: flex-end;
    }
    .chat-message::after {
      content: '';
      position: absolute;
      top: 0;
      width: 0;
      height: 0;
      border: 10px solid transparent;
    }
    .chat-bot::after {
      left: -10px;
      border-right-color: #dcf8c6;
    }
    .chat-user::after {
      right: -10px;
      border-left-color: #25d366;
    }
    .typing-indicator {
      display: flex;
      justify-content: space-between;
      align-self: flex-start;
      background-color: #dcf8c6;
      padding: 5px;
      border-radius: 10px;
      margin: 5px 0;
      width: 60px;
    }
    .typing-indicator div {
      width: 10px;
      height: 10px;
      background-color: #000;
      border-radius: 50%;
      animation: typing 1.5s infinite;
    }
    .typing-indicator div:nth-child(2) {
      animation-delay: 0.3s;
    }
    .typing-indicator div:nth-child(3) {
      animation-delay: 0.6s;
    }
    @keyframes typing {
      0% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
      100% { transform: translateY(0); }
    }
    .btn-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 10px;
      margin-bottom: 50px;
    }
    .btn, .confirm-btn {
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      margin: 10px auto;
      cursor: pointer;
      box-sizing: border-box;
      background-color: #25d366;
      color: white;
      width: 150px; /* Largura fixa */
      display: block;
      text-align: center;
    }
    .btn:hover {
      opacity: 0.9;
    }
    .dropdown, .telefone, .input-text {
      font-size: 18px;
      padding: 15px;
      border-radius: 5px;
      margin-top: 10px;
      width: calc(100% - 40px);
      background-color: #25d366;
      color: white;
      border: none;
    }
    .telefone::placeholder, .input-text::placeholder {
      color: white;
    }
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100vh;
      background-color: #e5ddd5;
      position: absolute;
      top: 0;
      z-index: 2;
    }
    .truck-animation {
      position: absolute;
      bottom: 50%;
      left: 0;
      width: 50px;
      transform: scaleX(-1);
      animation: drive 3s infinite linear;
    }
    @keyframes drive {
      0% { left: -50px; }
      100% { left: 100vw; }
    }
    .progress-bar {
      position: fixed,
      bottom: 0;
      left: 0;
      width: 0;
      height: 5px;
      background-color: #3498db;
      transition: width 2s;
      z-index: 3;
    }
  </style>
</head>
<body>
  <div class="loading" id="loading">
    <div class="truck-animation">
      <img src="https://i.imgur.com/4JLgWQN.png" alt="Carregando">
    </div>
  </div>
  <div class="progress-bar" id="progress-bar"></div>
  <div class="chat-container" id="chat">
    <div class="barra-superior">
      Fretes e Mudan√ßas!
    </div>
    <div id="mensagens" class="mensagens"></div>
    <div id="estado-container" class="btn-container" style="display: none;">
      <select id="estado-dropdown" class="dropdown" onchange="habilitarConfirmacao()">
        <option value="">Selecione um estado</option>
      </select>
      <div class="confirm-btn" id="confirma-estado" onclick="confirmarEstado()">Confirmar</div>
    </div>
    <div id="cidade-container" class="btn-container" style="display: none;">
      <select id="cidade-dropdown" class="dropdown" onchange="habilitarConfirmacaoCidade()">
        <option value="">Selecione uma cidade</option>
      </select>
      <div class="confirm-btn" id="confirma-cidade" onclick="confirmarCidade()">Confirmar</div>
    </div>
    <div id="telefone-container" class="btn-container" style="display: none;">
      <input type="tel" id="telefone-input" class="telefone" placeholder="(00) 00000-0000" inputmode="numeric" pattern="[0-9]*" autofocus>
      <div class="confirm-btn" onclick="confirmarTelefone()">Confirmar</div>
    </div>
    <div id="ajudante-container" class="btn-container" style="display: none;">
      <div class="btn" onclick="responderAjudante(true)">Sim</div>
      <div class="btn" onclick="responderAjudante(false)">N√£o</div>
    </div>
    <div id="saida-container" class="btn-container" style="display: none;">
      <select id="local-saida-dropdown" class="dropdown">
        <option value="">Selecionar</option>
        <option value="Casa">Casa</option>
        <option value="Apartamento com elevador">Apartamento com elevador</option>
        <option value="Apartamento sem elevador">Apartamento sem elevador</option>
        <option value="Outros">Outros</option>
      </select>
      <div class="btn" onclick="confirmarLocalSaida()">Confirmar</div>
    </div>
    <div id="destino-container" class="btn-container" style="display: none;">
      <select id="local-destino-dropdown" class="dropdown">
        <option value="">Selecionar</option>
        <option value="Casa">Casa</option>
        <option value="Apartamento com elevador">Apartamento com elevador</option>
        <option value="Apartamento sem elevador">Apartamento sem elevador</option>
        <option value="Outros">Outros</option>
      </select>
      <div class="btn" onclick="confirmarLocalDestino()">Confirmar</div>
    </div>
    <div id="bairro-saida-container" class="btn-container" style="display: none;">
      <input type="text" id="bairro-saida-input" class="input-text" placeholder="Digite o bairro de sa√≠da" autofocus>
      <div class="btn" onclick="confirmarBairroSaida()">Confirmar</div>
    </div>
    <div id="bairro-destino-container" class="btn-container" style="display: none;">
      <input type="text" id="bairro-destino-input" class="input-text" placeholder="Digite o bairro de destino" autofocus>
      <div class="btn" onclick="confirmarBairroDestino()">Confirmar</div>
    </div>
    <div id="transporte-container" class="btn-container" style="display: none;">
      <input type="text" id="transporte-input" class="input-text" placeholder="Digite o que voc√™ precisa transportar" autofocus>
      <div class="btn" onclick="confirmarTransporte()">Confirmar</div>
    </div>
  </div>
  <script>
    const estados = ["AC", "AL", "AM", "AP", "BA", "CE", "DF", "ES", "GO", "MA", "MG", "MS", "MT", "PA", "PB", "PE", "PI", "PR", "RJ", "RN", "RO", "RR", "RS", "SC", "SE", "SP"];
    const cidades = {
      "AC": ["Bujari", "Rio Branco"],
      "AL": ["Barra de Santo Ant√¥nio", "Coqueiro Seco", "Macei√≥", "Mal. Deodoro", "Paripueira", "Pilar", "Rio Largo", "Santa Luzia do Norte", "Satuba"],
      "AM": ["Careiro", "Iranduba", "Manacapuru", "Manaquiri", "Manaus", "Pres. Figueiredo", "Rio Preto da Eva"],
      "AP": ["Itaubal", "Macap√°", "Mazag√£o"],
      "BA": ["Anag√©", "Barra do Cho√ßa", "Cama√ßari", "Candeias", "Itamb√©", "Juazeiro", "Lauro de Freitas", "Mata de S√£o Jo√£o", "Planalto", "Salvador", "S√£o Sebasti√£o do Pass√©", "Sim√µes Filho", "Vit√≥ria da Conquista"],
      "CE": ["Acarape", "Altaneira", "Aracoiaba", "Aratuba", "Aurora", "Barbalha", "Barreira", "Baturit√©", "Beberibe", "Caridade", "Cariria√ßu", "Chorozinho", "Crato", "Eus√©bio", "Farias Brito", "Fortaleza", "Granjeiro", "Guaramiranga", "Horizonte", "Juazeiro do Norte", "Maracana√∫", "Miss√£o Velha", "Nova Olinda", "Pacajus", "Paracuru", "Paraipaba", "Paramoti", "Pentecoste", "Pindoretama", "S√£o Lu√≠s do Curu", "Umirim", "V√°rzea Alegre"],
      "DF": ["√Åguas Lindas de Goi√°s", "Bras√≠lia", "Formosa", "Luzi√¢nia", "Planaltina", "Santo Ant√¥nio do Descoberto", "Valpara√≠so de Goi√°s"],
      "ES": ["Cariacica", "Fund√£o", "Guarapari", "Santa Leopoldina", "Serra", "Viana", "Vila Velha", "Vit√≥ria"],
      "GO": ["Abadi√¢nia", "Acre√∫na", "An√°polis", "Aparecida de Goi√¢nia", "Aparecida do Rio Doce", "Aragoi√¢nia", "Brazabantes", "Ca√ßu", "Caldazinha", "Campo Limpo de Goi√°s", "Catura√≠", "Corumb√° de Goi√°s", "Gameleira de Goi√°s", "Goian√°polis", "Goi√¢nia", "Goianira", "Guap√≥", "Hidrol√¢ndia", "Indiara", "Inhumas", "Itarum√£", "Jata√≠", "Montividiu", "Ner√≥polis", "Nova Veneza", "Perol√¢ndia", "Piren√≥polis", "Planalmira", "Quirin√≥polis", "Rio Verde", "Santa Helena de Goi√°s", "Santo Ant√¥nio da Barra", "Santo Ant√¥nio de Goi√°s", "Trindade"],
      "MA": ["Bacabeira", "Buritirana", "Davin√≥polis", "Imperatriz", "Jo√£o Lisboa", "Raposa", "S√£o Jos√© de Ribamar", "S√£o Lu√≠s", "Sen. La Rocque"],
      "MG": ["A√ßucena", "Ant√¥nio Dias", "Araguari", "Belo Horizonte", "Belo Oriente", "Betim", "Bicas", "Caet√©", "Cap. Andrade", "Caratinga", "Cel. Pacheco", "Ch√°cara", "Dom Cavati", "Eng. Caldas", "Entre Folhas", "Ewbank da C√¢mara", "Goian√°", "Gov. Valadares", "Iapu", "Ibirit√©", "Inhapim", "Ipaba", "Ipatinga", "Itanhomi", "Joan√©sia", "Juiz de Fora", "Juramento", "Mar de Espanha", "M√°rio Campos", "Marip√° de Minas", "Matias Barbosa", "Montes Claros", "Naque", "Pequeri", "Piau", "Ribeir√£o das Neves", "Sabar√°", "Santa Luzia", "Santana do Para√≠so", "S√£o Sebasti√£o do Anta", "Sarzedo", "Sim√£o Pereira", "Tarumirim", "Tim√≥teo", "Uberl√¢ndia"],
      "MS": ["Campo Grande", "Jaraguari", "Ribas do Rio Pardo", "Rochedo", "Sidrol√¢ndia", "Terenos"],
      "MT": ["Acorizal", "Cuiab√°", "Jangada", "Nossa Sra. do Livramento", "Santo Ant√¥nio do Leverger", "V√°rzea Grande"],
      "PA": ["Ananindeua", "Bel√©m", "Benevides", "Cana√£ dos Caraj√°s", "Curion√≥polis", "Eldorado do Caraj√°s", "Itupiranga", "Marab√°", "Nova Ipixuna", "Parauapebas", "Santa Izabel do Par√°"],
      "PB": ["Alagoa Nova", "Bayeux", "Campina Grande", "Conde", "Jo√£o Pessoa", "Lagoa Seca", "Massaranduba", "Puxinan√£", "Santa Rita", "S√£o Sebasti√£o de Lagoa de Ro√ßa", "Serra Redonda"],
      "PE": ["Abreu e Lima", "Agrestina", "Altinho", "Brejo da Me. de Deus", "Cachoeirinha", "Camaragibe", "Camocim de S√£o F√©lix", "Caruaru", "Gravat√°", "Igarassu", "Jaboat√£o dos Guararapes", "Olinda", "Petrolina", "Recife", "Santa Cruz do Capibaribe", "S√£o Louren√ßo da Mata", "Tacaimb√≥", "Taguaritinga do Norte", "Toritama"],
      "PI": ["Alto Long√°", "Altos", "Campo Maior", "Coivaras", "Curralinhos", "Demerval Lob√£o", "Jos√© de Freitas", "Lagoa Alegre", "Mosenhor Gil", "Pau D¬¥Arco do Piau√≠", "Teresina", "Uni√£o"],
      "PR": ["Agudos do Sul", "Apucarana", "Arapongas", "Arauc√°ria", "Assis Chateaubriand", "Astorga", "Balsa Nova", "Cafel√¢ndia", "Camb√©", "Campina da Lagoa", "Campo Largo", "Cap. Le√¥nidas Marques", "Carambe√≠", "Cascavel", "Castro", "Colombo", "Contenda", "Corb√©lia", "Curitiba", "Dr. Camargo", "Fazenda Rio Grande", "Floresta", "Foz do Igua√ßu", "Ibipor√£", "Imbituva", "Ipiranga", "Itaipul√¢ndia", "Ivatuba", "Jataizinho", "Lapa", "Londrina", "Mal. Candido Rondon", "Mandagua√ßu", "Mandirituba", "Marialva", "Maring√°", "Matel√¢ndia", "Medianeira", "Missal", "Pai√ßandu", "Palmeira", "Palotina", "Piraquara", "Ponta Grossa", "Porto Amazonas", "Rio Branco do Sul", "Rol√¢ndia", "Santa Terezinha de Itaipu", "S√£o Jos√© dos Pinhais", "S√£o Miguel do Igua√ßu", "Sarandi", "Serran√≥polis do Igua√ßu", "Teixeira Soares", "Terra Roxa", "Tijucas do Sul", "Tunas do Paran√°"],
      "RJ": ["Ca√ßador", "Campos dos Goytacazes", "Cardoso Moreira", "Concei√ß√£o de Macabu", "Duque de Caxias", "Itabora√≠", "Itagua√≠", "Italva", "Mag√©", "Mesquita", "Nil√≥polis", "Niter√≥i", "Nova Igua√ßu", "Queimados", "Quissam√£", "Rio de Janeiro", "Santa Maria Madalena", "S√£o Francisco de Itabapoana", "S√£o Gon√ßalo", "S√£o Jo√£o de Meriti", "Serrinha"],
      "RN": ["Cear√°-Mirim", "Extremoz", "Maca√≠ba", "Natal", "Parnamirim", "S√£o Gon√ßalo do Amarante"],
      "RO": ["Ariquemes", "Buritis", "Cujubim", "Itapu√£ do Oeste", "Porto Velho"],
      "RR": ["Alto Alegre", "Amajari", "Boa Vista", "Caracara√≠", "Iracema", "Mucaja√≠", "Rorain√≥polis"],
      "RS": ["Agudo", "Ant√¥nio Prado", "Cachoeirinha", "Campo Bom", "Canoas", "Caxias do Sul", "Dois Irm√£os", "Eldorado do Sul", "Est√¢ncia Velha", "Farroupilha", "Flores da Cunha", "Formigueiro", "Gravata√≠", "Itaara", "Ivoti", "Morro Reuter", "Nova Santa Rita", "Nova P√°dua", "Nova Petr√≥polis", "Nova Roma do Sul", "Novo Hamburgo", "Port√£o", "Porto Alegre", "Restinga S√™ca", "Santa Maria", "S√£o Jo√£o do Pol√™sine", "S√£o Leopoldo", "S√£o Marcos", "S√£o Pedro do Sul", "S√£o Sep√©", "S√£o Vendelino", "Sapiranga", "Sapucaia do Sul", "Silveira Martins", "Vale Real", "Viam√£o"],
      "SC": ["Angelina", "Ant√¥nio Carlos", "Balne√°rio Barra do Sul", "Balne√°rio Cambori√∫", "Barra Velha", "Bigua√ßu", "Blumenau", "Bombinhas", "Brusque", "Cambori√∫", "Campo Alegre", "Corup√°", "Florian√≥polis", "Garuva", "Gaspar", "Gov. Celso Ramos", "Ilhota", "Indaial", "Itaja√≠", "Itapema", "Itapo√°", "Jaragu√° do Sul", "Joinville", "Navegantes", "Palho√ßa", "Penha", "Porto Belo", "Rancho Queimado", "Rodeio", "Santo Amaro da Imperatriz", "S√£o Bento do Sul", "S√£o Jos√©", "S√£o Pedro de Alc√¢ntara", "Schroeder", "Tijucas", "Timb√≥"],
      "SE": ["Aracaju", "Itaporanga d¬¥Ajuda", "Maruim", "Nossa Sra do Socorro", "Riachuelo", "Santo Amaro das Brotas", "S√£o Crist√≥v√£o"],
      "SP": ["Agudos", "Alum√≠nio", "Ara√ßoiaba da Serra", "Artur Nogueira", "Ava√≠", "Bady Bassitt", "B√°lsamo", "Barrinha", "Barueri", "Batatais", "Bauru", "Bertioga", "Biritiba Mirim", "Brodowski", "Buritizal", "Ca√ßapava", "Caieiras", "Cajamar", "Campinas", "Capela do Alto", "Capivari", "Cedral", "Charqueada", "Conchal", "Cosm√≥polis", "Cravinhos", "Cristais Paulista", "Cubat√£o", "Diadema", "Dumont", "Elias Fausto", "Eng. Coelho", "Franca", "Francisco Morato", "Franco da Rocha", "Guar√°", "Guararema", "Guaruj√°", "Holambra", "Hortol√¢ndia", "Ibir√°", "Indaiatuba", "Iper√≥", "Ipigu√°", "Itapecerica da Serra", "Itapevi", "Itaquaquecetuba", "Itatiba", "Itu", "Ituverava", "Jacare√≠", "Jaci", "Jardin√≥polis", "Jeriquara", "Jundia√≠", "Lagoinha", "Limeira", "Mairipor√£", "Mau√°", "Mirassol", "Mirassol√¢ndia", "Mogi das Cruzes", "Mombuca", "Monte Apraz√≠vel", "Monteiro Lobato", "Nova Odessa", "Nuporanga", "Onda Verde", "Orl√¢ndia", "Osasco", "Paraibuna", "Patroc√≠nio Paulista", "Paul√≠nia", "Pedregulho", "Piedade", "Pindamonhangaba", "Piracicaba", "Piraju√≠", "Piratininga", "Po√°", "Pontal", "Potirendaba", "Prad√≥polis", "Praia Grande", "Pres. Alves", "Reden√ß√£o da Serra", "Ribeir√£o Corrente", "Ribeir√£o Pires", "Rio Claro", "Rio Grande da Serra", "Roseira", "Sales Oliveira", "Salto de Pirapora", "Santa B√°rbara d¬¥Oeste", "Santa Branca", "Santos", "S√£o Bernardo do Campo", "S√£o Joaquim da Barra", "S√£o Jos√© da Bela Vista", "S√£o Jos√© do Rio Preto", "S√£o Jos√© dos Campos", "S√£o Luiz do Paraitinga", "S√£o Paulo", "S√£o Pedro", "S√£o Roque", "S√£o Sim√£o", "S√£o Vicente", "Serra Azul", "Serrana", "Sorocaba", "Sumar√©", "Tabo√£o da Serra", "Ribeir√£o Preto", "Taubat√©", "Trememb√©", "Uchoa", "Valinhos", "Vargem Grande Paulista", "Votorantim"]
    };

    let pedidoIdAtual = null;

    window.onload = () => {
      setTimeout(() => {
        document.getElementById('loading').style.display = 'none';
        document.getElementById('chat').style.visibility = 'visible';
        iniciarConversa();
      }, 2000);
      ativarConfirmacaoEnter();
    };

    function carregarEstados() {
      const estadoDropdown = document.getElementById('estado-dropdown');
      estados.forEach(estado => {
        const option = document.createElement('option');
        option.value = estado;
        option.innerText = estado;
        estadoDropdown.appendChild(option);
      });
      document.getElementById('estado-container').style.display = 'flex';
    }

    function carregarCidades(estadoSelecionado) {
      criarMensagem("Agora, selecione a cidade:", 'chat-bot');
      const cidadeDropdown = document.getElementById('cidade-dropdown');
      cidadeDropdown.innerHTML = '<option value="">Selecione uma cidade</option>';
      if (estadoSelecionado && cidades[estadoSelecionado]) {
        cidades[estadoSelecionado].forEach(cidade => {
          const option = document.createElement('option');
          option.value = cidade;
          option.innerText = cidade;
          cidadeDropdown.appendChild(option);
        });
        document.getElementById('cidade-container').style.display = 'block';
      }
    }

    const mensagens = [
      "Receba o melhor or√ßamento em 1 minuto! üöö",
      "Digite seu n√∫mero do Whatsapp com DDD: üì±",
      "Qual seu estado?"
    ];

    let precisaAjudante = "";
    let localSaida = "";
    let localDestino = "";
    let bairroSaida = "";
    let bairroDestino = "";
    let transporte = "";
    let telefone = "";

    function ativarConfirmacaoEnter() {
      document.querySelectorAll('.input-text, #telefone-input').forEach(input => {
        input.addEventListener('keydown', function(event) {
          if (event.key === 'Enter' || event.key === 'Return') {
            event.preventDefault();
            if (input.id === 'telefone-input') {
              confirmarTelefone();
            } else if (input.id === 'bairro-saida-input') {
              confirmarBairroSaida();
            } else if (input.id === 'bairro-destino-input') {
              confirmarBairroDestino();
            } else if (input.id === 'transporte-input') {
              confirmarTransporte();
            }
          }
        });
      });
    }

    function iniciarConversa() {
      setTimeout(() => {
        criarMensagem(mensagens[0], 'chat-bot');
        adicionarIndicador();
        setTimeout(() => {
          removerIndicador();
          criarMensagem(mensagens[1], 'chat-bot');
          solicitarTelefone();
        }, 4000);
      }, 1000);
    }
    
    function solicitarTelefone() {
      document.getElementById('telefone-container').style.display = 'flex';
      document.getElementById('telefone-input').focus();
    }

    function confirmarTelefone() {
      const input = document.getElementById('telefone-input');
      const valorDigitado = input.value.trim();
      const numeros = valorDigitado.replace(/\D/g, '');
      if (numeros.length < 10) {
        criarMensagem("Ops! O n√∫mero parece incompleto. Por favor, digite o DDD + n√∫mero completo (m√≠nimo 10 d√≠gitos).", 'chat-bot');
        input.focus();
        return;
      }
      telefone = valorDigitado;
      criarMensagem(`Telefone: ${telefone}`, 'chat-user');
      document.getElementById('telefone-container').style.display = 'none';
      criarMensagem(mensagens[2], 'chat-bot');
      mostrarEstados();
    }

    function adicionarIndicador() {
      const indicador = document.createElement('div');
      indicador.className = 'typing-indicator';
      for (let i = 0; i < 3; i++) {
        const dot = document.createElement('div');
        indicador.appendChild(dot);
      }
      document.getElementById('mensagens').appendChild(indicador);
      ajustarScroll();
    }

    function removerIndicador() {
      const indicador = document.querySelector('.typing-indicator');
      if (indicador) {
        indicador.remove();
      }
    }

    function mostrarEstados() {
      carregarEstados();
    }

    function habilitarConfirmacao() {
      const estadoSelecionado = document.getElementById('estado-dropdown').value;
      document.getElementById('confirma-estado').style.display = estadoSelecionado ? 'block' : 'none';
    }

    function mostrarCarregando() {
      const progressBar = document.getElementById('progress-bar');
      progressBar.style.width = '0%';
      progressBar.style.display = 'block';
      setTimeout(() => {
        progressBar.style.width = '100%';
      }, 100);
    }

    function ocultarCarregando() {
      const progressBar = document.getElementById('progress-bar');
      setTimeout(() => {
        progressBar.style.display = 'none';
      }, 2000);
    }

    function confirmarEstado() {
      const estado = document.getElementById('estado-dropdown').value;
      if (estado) {
        criarMensagem(`Estado selecionado: ${estado}`, 'chat-user');
        document.getElementById('estado-container').style.display = 'none';
        carregarCidades(estado);
      }
    }

    function habilitarConfirmacaoCidade() {
      const cidadeSelecionada = document.getElementById('cidade-dropdown').value;
      document.getElementById('confirma-cidade').style.display = cidadeSelecionada ? 'block' : 'none';
    }

    function confirmarCidade() {
      const cidade = document.getElementById('cidade-dropdown').value;
      const estado = document.getElementById('estado-dropdown').value;
      if (cidade) {
        criarMensagem(`Cidade selecionada: ${cidade}`, 'chat-user');
        document.getElementById('cidade-container').style.display = 'none';

        fetch('https://c0nv3n13nt3t3cn0l0g14jesus.sa.ngrok.io/registrarPedidoInicial', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ cidade, telefone, estado }) // Enviando o estado
        })
        .then(response => {
          if (!response.ok) throw new Error('Erro na resposta do servidor');
          return response.json();
        })
        .then(data => {
          pedidoIdAtual = data.pedidoId;
          console.log('Pedido registrado:', data);
          solicitarAjudante();
        })
        .catch(error => {
          console.error('Erro ao registrar pedido:', error);
          alert('Erro ao registrar pedido. Tente novamente.');
        });
      }
    }

    function solicitarAjudante() {
      criarMensagem("Voc√™ precisa de ajudante?", 'chat-bot');
      document.getElementById('ajudante-container').style.display = 'flex';
    }

    function registrarResposta(coluna, valor, finalizado = false) {
      fetch('https://c0nv3n13nt3t3cn0l0g14jesus.sa.ngrok.io/registrarResposta', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ pedidoId: pedidoIdAtual, coluna, valor, finalizado })
      })
      .then(response => {
        if (!response.ok) throw new Error('Erro na resposta do servidor');
        return response.json();
      })
      .then(data => console.log('Resposta registrada:', data))
      .catch(error => console.error('Erro ao registrar resposta:', error));
    }

    function responderAjudante(precisa) {
      const resposta = precisa ? "Sim" : "N√£o";
      criarMensagem(`Ajudante: ${resposta}`, 'chat-user');
      registrarResposta('D', resposta);
      document.getElementById('ajudante-container').style.display = 'none';
      solicitarLocalSaida();
    }

    function solicitarLocalSaida() {
      criarMensagem("De onde voc√™ vai sair?", 'chat-bot');
      document.getElementById('saida-container').style.display = 'flex';
    }

    function confirmarLocalSaida() {
      localSaida = document.getElementById('local-saida-dropdown').value;
      if (localSaida) {
        criarMensagem(`Sa√≠da: ${localSaida}`, 'chat-user');
        registrarResposta('E', localSaida);
        document.getElementById('saida-container').style.display = 'none';
        solicitarLocalDestino();
      }
    }

    function solicitarLocalDestino() {
      criarMensagem("Para onde voc√™ vai?", 'chat-bot');
      document.getElementById('destino-container').style.display = 'flex';
    }

    function confirmarLocalDestino() {
      localDestino = document.getElementById('local-destino-dropdown').value;
      if (localDestino) {
        criarMensagem(`Destino: ${localDestino}`, 'chat-user');
        registrarResposta('F', localDestino);
        document.getElementById('destino-container').style.display = 'none';
        solicitarBairroSaida();
      }
    }

    function solicitarBairroSaida() {
      criarMensagem("Qual o bairro de sa√≠da?", 'chat-bot');
      document.getElementById('bairro-saida-container').style.display = 'flex';
      document.getElementById('bairro-saida-input').focus();
    }

    function confirmarBairroSaida() {
      bairroSaida = document.getElementById('bairro-saida-input').value;
      if (bairroSaida) {
        criarMensagem(`Bairro de Sa√≠da: ${bairroSaida}`, 'chat-user');
        registrarResposta('G', bairroSaida);
        document.getElementById('bairro-saida-container').style.display = 'none';
        solicitarBairroDestino();
      }
    }

    function solicitarBairroDestino() {
      criarMensagem("Qual o bairro de destino?", 'chat-bot');
      document.getElementById('bairro-destino-container').style.display = 'flex';
      document.getElementById('bairro-destino-input').focus();
    }

    function confirmarBairroDestino() {
      bairroDestino = document.getElementById('bairro-destino-input').value;
      if (bairroDestino) {
        criarMensagem(`Bairro de Destino: ${bairroDestino}`, 'chat-user');
        registrarResposta('H', bairroDestino);
        document.getElementById('bairro-destino-container').style.display = 'none';
        solicitarTransporte();
      }
    }

    function solicitarTransporte() {
      criarMensagem("O que voc√™ precisa transportar?", 'chat-bot');
      document.getElementById('transporte-container').style.display = 'flex';
      document.getElementById('transporte-input').focus();
    }

    function confirmarTransporte() {
      transporte = document.getElementById('transporte-input').value;
      if (transporte) {
        criarMensagem(`Transporte: ${transporte}`, 'chat-user');
        registrarResposta('I', transporte, true);
        document.getElementById('transporte-container').style.display = 'none';
        criarMensagem(
          "Pedido enviado! Em instantes nossa equipe te chama no WhatsApp. Aproveite e conhe√ßa nosso trabalho no Instagram! üòä",
          'chat-bot'
        );
        setTimeout(function() {
          window.location.href = 'https://www.instagram.com/convenientetecnologia/?ref=fretes-site';
        }, 5000);
      }
    }

    function criarMensagem(texto, classe) {
      const mensagem = document.createElement('div');
      mensagem.className = `chat-message ${classe}`;
      mensagem.textContent = texto;
      const mensagensContainer = document.getElementById('mensagens');
      mensagensContainer.appendChild(mensagem);
      ajustarScroll();
    }

    function ajustarScroll() {
      const mensagensContainer = document.getElementById('mensagens');
      requestAnimationFrame(() => {
        mensagensContainer.scrollTop = mensagensContainer.scrollHeight;
      });
    }

    function ajustarParaTeclado() {
      const mensagensContainer = document.getElementById('mensagens');
      let alturaDisponivel = window.innerHeight;
      if (window.visualViewport) {
        alturaDisponivel = window.visualViewport.height - 400;
      }
      mensagensContainer.style.height = alturaDisponivel + 'px';
      mensagensContainer.offsetHeight;
      setTimeout(() => {
        ajustarScroll();
      }, 500);
    }

    function resetarAltura() {
      const mensagensContainer = document.getElementById('mensagens');
      mensagensContainer.style.height = 'calc(100vh - 160px)';
      ajustarScroll();
    }

    document.querySelectorAll('.input-text, #telefone-input').forEach(input => {
      input.addEventListener('focus', ajustarParaTeclado);
      input.addEventListener('blur', resetarAltura);
    });

    window.addEventListener('resize', ajustarParaTeclado);

    document.getElementById('telefone-input').addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      let formattedValue = '';
      if (value.length > 2) {
        formattedValue += `(${value.substring(0, 2)}) `;
        value = value.substring(2);
      }
      if (value.length > 5) {
        formattedValue += `${value.substring(0, 5)}-${value.substring(5, 9)}`;
      } else {
        formattedValue += value;
      }
      e.target.value = formattedValue;
    });
  </script>
</body>
</html>